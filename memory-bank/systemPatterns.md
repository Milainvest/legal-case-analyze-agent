# System Patterns

## Architecture Overview

*   The system is planned to use a **Microservices Architecture**. (Ref: docs/requirment_definition.md Section 4.2, 4.3)
*   Key components include: Frontend (Next.js), Backend API (FastAPI), AI Processing (LangChain/OpenAI), Databases (PostgreSQL, Vector DB), Cache (Redis), Message Queue (RabbitMQ). (Ref: Section 5)
*   A potential high-level flow:
    ```mermaid
    graph TD
        User --> FE[Frontend (Next.js)];
        FE --> BE{Backend API (FastAPI)};
        BE --> DB[(PostgreSQL)];
        BE --> VDB[(Vector DB)];
        BE --> Cache[(Redis)];
        BE --> MQ([RabbitMQ for async tasks]);
        MQ --> Worker[AI Worker (LangChain/OpenAI)];
        Worker --> BE;
        Worker --> VDB;
        Worker --> Ext[External Case Sources];
    ```

## Key Technical Decisions

*   **Backend Framework:** FastAPI chosen for Python backend, leveraging async capabilities and OpenAPI generation. (Ref: 5.1)
*   **Frontend Framework:** Next.js (AppRouter) selected for the TypeScript frontend. (Ref: 5.2)
*   **AI Integration:** LangChain to orchestrate interactions with OpenAI API and potentially custom prompts. (Ref: 5.1)
*   **Databases:** PostgreSQL for structured data, a Vector DB (Pinecone/FAISS) for embeddings/similarity search, Redis for caching. (Ref: 5.1)
*   **Asynchronous Processing:** RabbitMQ for handling potentially long-running tasks like report generation or scraping. (Ref: 5.1)
*   **Microservices:** Explicitly mentioned as the target architecture for scalability and maintainability. (Ref: 4.2, 4.3)

## Design Patterns

*   **Dependency Injection:** Supported by FastAPI. (Ref: 5.1)
*   **ORM:** SQLAlchemy for database interactions. (Ref: 5.1)
*   **Repository Pattern:** Likely to be used with SQLAlchemy (Implied).
*   **Service Layer:** Common pattern with FastAPI/Microservices (Implied).
*   **Circuit Breaker:** Mentioned for microservice communication. (Ref: 4.2)
*   [Other patterns TBD as implementation progresses]

## Component Relationships

*   **Frontend <-> Backend:** Likely REST API calls (OpenAPI spec generated by FastAPI). (Ref: 5.1, 3.4)
*   **Backend Services:** Communication via gRPC is mentioned. (Ref: 4.2)
*   **Backend -> Databases/Cache/MQ:** Standard client library interactions.
*   **Backend/Worker -> AI Services:** API calls to OpenAI, potentially orchestrated by LangChain.
*   **Worker -> External Sources:** Web scraping (details TBD).

*(This file documents the technical blueprint based on the requirements. It will evolve as implementation details are finalized.)*
